<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Schedule Meeting - MeetTwin</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body { font-family:'Inter',sans-serif; margin:0; padding:2rem; background:#f9f9f9; }
h1 { text-align:center; color:#4b2aad; margin-bottom:2rem; }
form { max-width:500px; margin:0 auto; background:#fff; padding:2rem; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
label { display:block; margin-bottom:0.5rem; font-weight:600; }
input, textarea { width:100%; padding:0.5rem; margin-bottom:1rem; border:1px solid #ccc; border-radius:5px; font-size:1rem; }
textarea { resize:vertical; }
button { padding:0.7rem 1.2rem; background:#4b2aad; color:#fff; border:none; border-radius:5px; font-weight:600; cursor:pointer; }
button:hover { background:#3a1f8f; }
.success { text-align:center; color:green; margin-top:1rem; }
table { width:100%; max-width:800px; margin:2rem auto 0 auto; border-collapse:collapse; }
th, td { padding:12px; border:1px solid #ddd; text-align:center; }
th { background:#4b2aad; color:#fff; }
tr:nth-child(even) { background:#f2f2f2; }
a { color:#4b2aad; font-weight:600; text-decoration:none; }
a:hover { text-decoration:underline; }
.delete-btn { padding:0.3rem 0.6rem; background:#f44336; color:#fff; border:none; border-radius:5px; cursor:pointer; }
.delete-btn:hover { background:#d32f2f; }
</style>
</head>
<body>
  <button class="back-btn" onclick="window.location.href='index.html'">‚Üê Back</button>

<h1>Schedule a Meeting</h1>

<form id="scheduleForm">
  <label for="date">Meeting Date:</label>
  <input type="date" id="date" required>

  <label for="startTime">Start Time:</label>
  <input type="time" id="startTime" required>

  <label for="endTime">End Time:</label>
  <input type="time" id="endTime" required>

  <label for="details">Details / Notes:</label>
  <textarea id="details" rows="4" placeholder="Enter meeting agenda or notes"></textarea>

  <button type="submit">Schedule Meeting</button>
</form>

<div class="success" id="successMsg"></div>

<h2 style="text-align:center; margin-top:3rem;">Upcoming Scheduled Meetings</h2>
<table>
  <thead>
    <tr>
      <th>Meeting ID</th>
      <th>Date</th>
      <th>Start Time</th>
      <th>End Time</th>
      <th>Details</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="scheduleTable">
  </tbody>
</table>

<script>
// Generate unique Meeting ID
function generateMeetingId() {
  return 'MT-' + Math.random().toString(36).substr(2, 9).toUpperCase();
}

// Load scheduled meetings from localStorage
function loadSchedules() {
  const schedules = JSON.parse(localStorage.getItem('schedules') || "[]");
  const table = document.getElementById('scheduleTable');
  table.innerHTML = "";
  if (schedules.length === 0) {
    table.innerHTML = `<tr><td colspan="6">No scheduled meetings</td></tr>`;
    return;
  }
  schedules.forEach((item, index) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><a href="/meeting.html?room=${item.meetingId}">${item.meetingId}</a></td>
      <td>${item.date}</td>
      <td>${item.startTime}</td>
      <td>${item.endTime}</td>
      <td>${item.details || '-'}</td>
      <td><button class="delete-btn" onclick="deleteMeeting(${index})">Delete</button></td>
    `;
    table.appendChild(tr);
  });
}

// Delete a scheduled meeting
function deleteMeeting(index) {
  let schedules = JSON.parse(localStorage.getItem('schedules') || "[]");
  if (!confirm(`Are you sure you want to delete meeting ${schedules[index].meetingId}?`)) return;
  schedules.splice(index, 1);
  localStorage.setItem('schedules', JSON.stringify(schedules));
  loadSchedules();
}

// Handle form submission
document.getElementById('scheduleForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const date = document.getElementById('date').value;
  const startTime = document.getElementById('startTime').value;
  const endTime = document.getElementById('endTime').value;
  const details = document.getElementById('details').value;

  if (!date || !startTime || !endTime) {
    alert("Please fill in all required fields.");
    return;
  }

  const meetingId = generateMeetingId();

  // Save to localStorage
  let schedules = JSON.parse(localStorage.getItem('schedules') || "[]");
  schedules.push({ meetingId, date, startTime, endTime, details });
  localStorage.setItem('schedules', JSON.stringify(schedules));

  // Show success message
  const msg = document.getElementById('successMsg');
  msg.innerText = `Meeting scheduled successfully!\nID: ${meetingId}\nDate: ${date} ${startTime} - ${endTime}`;

  // Reset form
  document.getElementById('scheduleForm').reset();

  // Reload table
  loadSchedules();
});

// Initial load
loadSchedules();
</script>

</body>
</html>
